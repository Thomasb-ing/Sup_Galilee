X=mvrnorm(n = N, mu, Sigma)
}
rho1=0.5
rho2=1
mu=0
sigma=diag(rep(1,5))
sigma[1,3]=rho1
sigma[3,1]=rho1
sigma[2,4]=rho2
sigma[4,2]=rho2
N=30
for (i in 1:1000) {
X=mvrnorm(n = N, mu, sigma)
}
X=mvrnorm(N, mu, sigma)
mu=c(0,0,0,0,0)
mu
mu=c(0,0,0,0,0)''
mu=c(0,0,0,0,0)'
mu
;
''
t(mu)
mu
t(mu)
mu
mu
t(t(mu))
mu=t(t(mu))
mu
X=mvrnorm(N, mu, sigma)
X
t(X)
X[,1]
X
reg <- lm(cbind(X[,1],X[,2])~X[,3]+X[,4]+X[,5],data=X)
X
X=as.data.frame(mvrnorm(N, mu, sigma))
reg <- lm(cbind(X[,1],X[,2])~X[,3]+X[,4]+X[,5],data=X)
reg
linearHypothesis(reg,cbind(0,diag(3)),test="Wilks")
require(car)
linearHypothesis(reg,cbind(0,diag(3)),test="Wilks")
eigen(sigma)$values
rank(sigma)
rho1=0.7
rho2=1
mu=c(0,0,0,0,0)
sigma=diag(rep(1,5))
sigma[1,3]=rho1
sigma[3,1]=rho1
sigma[2,4]=rho2
sigma[4,2]=rho2
eigen(sigma)$values
rho1=1
rho2=1
mu=c(0,0,0,0,0)
sigma=diag(rep(1,5))
sigma[1,3]=rho1
sigma[3,1]=rho1
sigma[2,4]=rho2
sigma[4,2]=rho2
eigen(sigma)$values
rho1=0.1
rho2=1
mu=c(0,0,0,0,0)
sigma=diag(rep(1,5))
sigma[1,3]=rho1
sigma[3,1]=rho1
sigma[2,4]=rho2
sigma[4,2]=rho2
eigen(sigma)$values
rho1=0.1
rho2=0.8
mu=c(0,0,0,0,0)
sigma=diag(rep(1,5))
sigma[1,3]=rho1
sigma[3,1]=rho1
sigma[2,4]=rho2
sigma[4,2]=rho2
eigen(sigma)$values
X=as.data.frame(mvrnorm(N, mu, sigma))
reg <- lm(cbind(X[,1],X[,2])~X[,3]+X[,4]+X[,5],data=X)
linearHypothesis(reg,cbind(0,diag(3)),test="Wilks")
X=as.data.frame(mvrnorm(N, mu, sigma))
reg <- lm(cbind(X[,1],X[,2])~X[,3]+X[,4]+X[,5],data=X)
linearHypothesis(reg,cbind(0,diag(3)),test="Pillai")
0<1
0<1+0<1
0<10<1
TRUE+TRUE
3+TRUE
1+ 1<0
1+ 1>0
1+ (1>0)
load("C:/Users/thobi/Documents/Sup_Galilee/CANADA/COURS/STT6515/Final/croissance.rda")
View(X)
View(X)
load("C:/Users/thobi/Documents/Sup_Galilee/CANADA/COURS/STT6515/Final/croissance.rda")
View(croissance)
croissance
load("C:/Users/thobi/Documents/Sup_Galilee/CANADA/COURS/STT6515/Final/croissance.rda")
load("C:/Users/thobi/Documents/Sup_Galilee/CANADA/COURS/STT6515/Final/croissance.rda")
croissance
load("C:/Users/thobi/Documents/Sup_Galilee/CANADA/COURS/STT6515/Final/croissance.rda")
croissance$V1
load("C:/Users/thobi/Documents/Sup_Galilee/CANADA/COURS/STT6515/Final/croissance.rda")
croissance$V1
Z=croissance;
Z$V1
Z
Z$V1
Z=c(croissance$V1-2*croissance$V2+croissance$V3,croissance$V2-2*croissance$V3+croissance$V4);
z
load("C:/Users/thobi/Documents/Sup_Galilee/CANADA/COURS/STT6515/Final/croissance.rda")
croissance$V1
Z=data.frame(y1=croissance$V1-2*croissance$V2+croissance$V3,y2 =croissance$V2-2*croissance$V3+croissance$V4)
Z
load("C:/Users/thobi/Documents/Sup_Galilee/CANADA/COURS/STT6515/Final/croissance.rda")
croissance$V1
Z1=data.frame(y1=croissance$V1-2*croissance$V2+croissance$V3)
Z2 =data.frame(y1=croissance$V2-2*croissance$V3+croissance$V4)
Z=rbind(Z1,Z2)
View(Z)
Z
R <- 1000
X <- as.matrix(Z)
n <- nrow(X)
tx <- summary(manova(X ~ 1),intercept=TRUE)$stats[3]
tgx.vec <- NULL
for(r in 1:R){
+ g <- sample(c(-1,1),n,replace=TRUE)
+ gX <- as.matrix(g*X)
+ tgx <- summary(manova(gX ~ 1),intercept=TRUE)$stats[3]
+ tgx.vec <- c(tgx.vec, tgx)
}
tx>quantile(tgx.vec,.95)
load("C:/Users/thobi/Documents/Sup_Galilee/CANADA/COURS/STT6515/Final/croissance.rda")
croissance$V1
Z1=data.frame(y1=croissance$V1-2*croissance$V2+croissance$V3)
Z2 =data.frame(y1=croissance$V2-2*croissance$V3+croissance$V4)
Z=data.frame(y1=croissance$V1-2*croissance$V2+croissance$V3,y2=croissance$V2-2*croissance$V3+croissance$V4)
R <- 1000
X <- as.matrix(Z)
n <- nrow(X)
tx <- summary(manova(X ~ 1),intercept=TRUE)$stats[3]
tgx.vec <- NULL
for(r in 1:R){
+ g <- sample(c(-1,1),n,replace=TRUE)
+ gX <- as.matrix(g*X)
+ tgx <- summary(manova(gX ~ 1),intercept=TRUE)$stats[3]
+ tgx.vec <- c(tgx.vec, tgx)
}
tx>quantile(tgx.vec,.95)
R <- 1000
X <- as.matrix(Z)
n <- nrow(X)
tx <- summary(manova(X ~ 1),intercept=TRUE)$stats[3]
tgx.vec <- NULL
for(r in 1:R){
+ g <- sample(c(-1,1),n,replace=TRUE)
+ gX <- as.matrix(g*X)
+ tgx <- summary(manova(gX ~ 1),intercept=TRUE)$stats[3]
+ tgx.vec <- c(tgx.vec, tgx)
}
p.val <- mean(tgx.vec>=tx)
g <- sample(c(-1,1),n,replace=TRUE)
load("C:/Users/thobi/Documents/Sup_Galilee/CANADA/COURS/STT6515/Final/croissance.rda")
croissance$V1
Z1=data.frame(y1=croissance$V1-2*croissance$V2+croissance$V3)
Z2 =data.frame(y1=croissance$V2-2*croissance$V3+croissance$V4)
Z=data.frame(y1=croissance$V1-2*croissance$V2+croissance$V3,y2=croissance$V2-2*croissance$V3+croissance$V4)
R <- 1000
X <- as.matrix(Z)
n <- nrow(X)
tx <- summary(manova(X ~ 1),intercept=TRUE)$stats[3]
tgx.vec <- NULL
for(r in 1:R){
+ g <- sample(c(-1,1),n,replace=TRUE)
+ gX <- as.matrix(g*X)
+ tgx <- summary(manova(gX ~ 1),intercept=TRUE)$stats[3]
+ tgx.vec <- c(tgx.vec, tgx)
}
p.val <- mean(tgx.vec>=tx)
R <- 1000
X <- as.matrix(Z)
n <- nrow(X)
tx <- summary(manova(X ~ 1),intercept=TRUE)$stats[3]
tgx.vec <- NULL
for(r in 1:R){
g <- sample(c(-1,1),n,replace=TRUE)
+ gX <- as.matrix(g*X)
+ tgx <- summary(manova(gX ~ 1),intercept=TRUE)$stats[3]
+ tgx.vec <- c(tgx.vec, tgx)
}
p.val <- mean(tgx.vec>=tx)
R <- 1000
X <- as.matrix(Z)
n <- nrow(X)
tx <- summary(manova(X ~ 1),intercept=TRUE)$stats[3]
tgx.vec <- NULL
for(r in 1:R){
g <- sample(c(-1,1),n,replace=TRUE)
gX <- as.matrix(g*X)
tgx <- summary(manova(gX ~ 1),intercept=TRUE)$stats[3]
tgx.vec <- c(tgx.vec, tgx)
}
p.val <- mean(tgx.vec>=tx)
p.val
load("C:/Users/thobi/Documents/Sup_Galilee/CANADA/COURS/STT6515/Final/croissance.rda")
croissance$V1
Z1=data.frame(y1=croissance$V1-2*croissance$V2+croissance$V3)
Z2 =data.frame(y1=croissance$V2-2*croissance$V3+croissance$V4)
Z=data.frame(y1=croissance$V1-2*croissance$V2+croissance$V3,y2=croissance$V2-2*croissance$V3+croissance$V4)
R <- 1000
X <- as.matrix(Z)
n <- nrow(X)
tx <- summary(manova(X ~ 1),intercept=TRUE)$stats[3]
tgx.vec <- NULL
for(r in 1:R){
g <- sample(c(-1,1),n,replace=TRUE)
gX <- as.matrix(g*X)
tgx <- summary(manova(gX ~ 1),intercept=TRUE)$stats[3]
tgx.vec <- c(tgx.vec, tgx)
}
p.val <- mean(tgx.vec>=tx)
load("C:/Users/thobi/Documents/Sup_Galilee/CANADA/COURS/STT6515/Final/sphericite.rda")
View(gX)
View(sphericite)
sphericite
mean(sphericite)
mean(sphericite$V1)
colMeans(sphericite)
colMeans(sphericite)%*%t(colMeans(sphericite))
t(colMeans(sphericite))%*%colMeans(sphericite)
load("C:/Users/thobi/Documents/Sup_Galilee/CANADA/COURS/STT6515/Final/sphericite.rda")
sphericity.test <- function(X){
S <- var(X)
dec.spec <- eigen(S,symmetric = TRUE, only.values = TRUE)
p <- ncol(X)
N <- nrow(X)
mean <-t(colMeans(sphericite))%*%colMeans(sphericite)
W <- p^p*prod(dec.spec$values)/((sum(dec.spec$values)+N*mean)^p)
n <- nrow(X)-1
df <- p*(p+1)/2-1+p
rho <- 1-(2*p**2+p+2)/(6*p*n)
omega2 <- (p+2)*(p-1)*(p-2)*(2*p^3+6*p^2+3*p+2)/(288*p^2*n^2*rho^2)
Z <- -n*rho*log(W)
pvalue <- 1-(pchisq(Z,df)+omega2*(pchisq(Z,df+4)-pchisq(Z,df)))
pvalue}
sphericity.test(sphericite)
read.table("poterie.txt", header = TRUE)
read.table("C:/Users/thobi/Documents/Sup_Galilee/CANADA/COURS/STT6515/Final/poterie.txt", header = TRUE)
pot=read.table("C:/Users/thobi/Documents/Sup_Galilee/CANADA/COURS/STT6515/Final/poterie.txt", header = TRUE)
pot$site
Lpot=poterie[,poterie$site=L]
Lpot=poterie[,"poterie$site==L"]
Lpot=poterie[,"pot$site==L"]
Lpot=pot[,"pot$site==L"]
pot$site==L
pot$site=="L"
Lpot=pot[,pot$site=="L"]
Lpot=pot[pot$site=="L",]
pot=read.table("C:/Users/thobi/Documents/Sup_Galilee/CANADA/COURS/STT6515/Final/poterie.txt", header = TRUE)
Lpot=pot[,pot$site=="L"]
Cpot=pot[,pot$site=="C"]
Ipot=pot[,pot$site=="I"]
Apot=pot[,pot$site=="A"]
pot=read.table("C:/Users/thobi/Documents/Sup_Galilee/CANADA/COURS/STT6515/Final/poterie.txt", header = TRUE)
Lpot=pot[pot$site=="L",]
Cpot=pot[pot$site=="C",]
Ipot=pot[pot$site=="I",]
Apot=pot[pot$site=="A",]
Apot
Apot=Apot[,-1]
Apot
Apot=pot[pot$site=="A",-1]
Apot
pot=read.table("C:/Users/thobi/Documents/Sup_Galilee/CANADA/COURS/STT6515/Final/poterie.txt", header = TRUE)
Lpot=pot[pot$site=="L",-1]
Cpot=pot[pot$site=="C",-1]
Ipot=pot[pot$site=="I",-1]
Apot=pot[pot$site=="A",-1]
Apot
mvn(Lpot,mvnTest ="hz")$multivariateNormality[3]<.05
mvn(Cpot,mvnTest ="hz")$multivariateNormality[3]<.05
mvn(Ipot,mvnTest ="hz")$multivariateNormality[3]<.05
mvn(Apot,mvnTest ="hz")$multivariateNormality[3]<.05
require(MVN)
mvn(Lpot,mvnTest ="hz")$multivariateNormality[3]<.05
mvn(Cpot,mvnTest ="hz")$multivariateNormality[3]<.05
mvn(Ipot,mvnTest ="hz")$multivariateNormality[3]<.05
mvn(Apot,mvnTest ="hz")$multivariateNormality[3]<.05
require(MVN)
require("MVN")
library("MVN")
library(MVN)
require(CRAN)
mvn(Lpot,mvnTest ="hz")$multivariateNormality[3]<.05
mvn(Cpot,mvnTest ="hz")$multivariateNormality[3]<.05
mvn(Ipot,mvnTest ="hz")$multivariateNormality[3]<.05
mvn(Apot,mvnTest ="hz")$multivariateNormality[3]<.05
require(MVN)
mvn(Lpot,mvnTest ="hz")$multivariateNormality[3]<.05
mvn(Cpot,mvnTest ="hz")$multivariateNormality[3]<.05
mvn(Ipot,mvnTest ="hz")$multivariateNormality[3]<.05
mvn(Apot,mvnTest ="hz")$multivariateNormality[3]<.05
require(MVN)
mvn(pot[,-1],mvnTest ="hz")$multivariateNormality[3]<.05
mvn(Lpot,mvnTest ="hz")$multivariateNormality[3]<.05
mvn(Cpot,mvnTest ="hz")$multivariateNormality[3]<.05
mvn(Ipot,mvnTest ="hz")$multivariateNormality[3]<.05
mvn(Apot,mvnTest ="hz")$multivariateNormality[3]<.05
require(MVN)
mvn(pot[,-1],mvnTest ="hz")$multivariateNormality[3]
mvn(Lpot,mvnTest ="hz")$multivariateNormality[3]<.05
mvn(Cpot,mvnTest ="hz")$multivariateNormality[3]<.05
mvn(Ipot,mvnTest ="hz")$multivariateNormality[3]<.05
mvn(Apot,mvnTest ="hz")$multivariateNormality[3]<.05
ggplot(data, aes(x = CLASSE, fill = SEXE)) +
geom_bar() +
labs(title = "Nombre de décès par catégorie sociale et par sexe",
x = "Catégorie sociale", y = "Nombre de décès")
ggplot2(data, aes(x = CLASSE, fill = SEXE)) +
geom_bar() +
labs(title = "Nombre de décès par catégorie sociale et par sexe",
x = "Catégorie sociale", y = "Nombre de décès")
# Chunk 18
library(nortest)
library(OneTwoSamples)
# Chunk 19
data=read.csv("Naiss_fr_2019.csv")
# Chunk 20
# Compter le nombre de garçons et de filles
sex_counts <- table(data$SEXE)
# Afficher les résultats
print(sex_counts)
prop.test(sex_counts, sum(sex_counts), p =0.5)
prop.test(sex_counts, sum(sex_counts), p =0.5,alternative = "greater")
# Calculer la moyenne de la taille pour les garçons et les filles
boy_mean <- mean(data$TAILLE[data$SEXE == 1])
girl_mean <- mean(data$TAILLE[data$SEXE == 2])
# Afficher les résultats
print(paste("Moyenne de la taille des garçons :", boy_mean))
print(paste("Moyenne de la taille des filles :", girl_mean))
# Effectuer un test t pour vérifier si la différence de taille est significative
t.test(data$TAILLE ~ data$SEXE)
# Chunk 21
data=read.csv("Life_expectancy_large.csv")
# Chunk 22
library(dplyr)
data %>% group_by(CLASSE) %>%  summarize(mean_age = mean(AGE))
# Chunk 23
library(ggplot2)
ggplot(data, aes(x=CLASSE)) + geom_bar(aes(fill=CLASSE))
# Chunk 24
ggplot(data, aes(x="", y=DATE, fill=DATE)) + geom_bar(width = 1, stat = "identity") + coord_polar("y", start=0)
# Chunk 25
ggplot(data, aes(x=CLASSE, y=AGE, fill=CLASSE)) + geom_boxplot()
data=read.csv("Life_expectancy_large.csv")
setwd("C:/Users/thobi/Documents/Sup_Galilee/MACS3/Option/Stat_bio_médicale")
data=read.csv("Life_expectancy_large.csv")
```{r echo=TRUE}
data=read.csv("Life_expectancy_large.csv")
library(dplyr)
data %>% group_by(CLASSE) %>%  summarize(mean_age = mean(AGE))
library(ggplot2)
ggplot(data, aes(x=CLASSE)) + geom_bar(aes(fill=CLASSE))
ggplot(data, aes(x="", y=DATE, fill=DATE)) + geom_bar(width = 1, stat = "identity") + coord_polar("y", start=0)
ggplot(data, aes(x=CLASSE, y=AGE, fill=CLASSE)) + geom_boxplot()
ggplot(data, aes(x="AGE", y="CLASSE", fill=CLASSE)) + geom_bar(width = 1, stat = "identity") + coord_polar("y", start=0)
library(ggplot2)
ggplot(data, aes(x=CLASSE)) + geom_bar(aes(fill=CLASSE))
ggboxplot(
iris2, x = "DATE", y = c("SEXE", "CLASSE"),
merge = TRUE, palette = "jco"
)
library(tidyverse)
library(ggpubr)
library(rstatix)
library(car)
library(broom)
ggboxplot(
iris2, x = "DATE", y = c("SEXE", "CLASSE"),
merge = TRUE, palette = "jco"
)
library(tidyverse)
library(ggpubr)
library(rstatix)
library(car)
library(broom)
ggboxplot(
data, x = "DATE", y = c("SEXE", "CLASSE"),
merge = TRUE, palette = "jco"
)
library(tidyverse)
library(ggpubr)
library(rstatix)
library(car)
library(broom)
ggboxplot(
data, x = "AGE", y = c("SEXE", "CLASSE"),
merge = TRUE, palette = "jco"
)
library(ggplot2)
ggplot(data, aes(x=CLASSE)) + geom_bar(aes(fill=CLASSE))
library(ggplot2)
ggplot(data, aes(x=CLASSE)) + geom_bar(aes(fill=c(CLASSE,SEXE)))
library(ggplot2)
ggplot(data, aes(x=CLASSE)) + geom_bar(aes(fill=SEXE))
library(ggplot2)
ggplot(data, aes(x=CLASSE)) + geom_bar(aes(fill=SEXE))
library(ggplot2)
ggplot(data, aes(x=CLASSE)) + geom_bar(aes(fill=CLASSE))
library(dplyr)
data %>% group_by(CLASSE) %>%  summarize(mean_age = mean(AGE))
ggplot(data, aes(x = CLASSE, fill = SEXE)) +
geom_bar() +
labs(title = "Nombre de décès par catégorie sociale et par sexe",
x = "Catégorie sociale", y = "Nombre de décès")
ggplot(data, aes(x="", y=DATE, fill=DATE)) + geom_bar(width = 1, stat = "identity") + coord_polar("y", start=0)
ggplot(data, aes(x=CLASSE, y=AGE, fill=CLASSE)) + geom_boxplot()
ggplot(data, aes(x = CLASSE, fill = SEXE)) +
geom_bar(position = "dodge") +
labs(title = "Nombre de décès par catégorie sociale et par sexe",
x = "Catégorie sociale", y = "Nombre de décès")
ggplot(data, aes(x=CLASSE, y=AGE, fill=CLASSE)) + geom_boxplot()
ggplot(data, aes(x=CLASSE, y=AGE, fill=c(CLASSE,SEXE))) + geom_boxplot()
ggplot(data, aes(x=CLASSE, y=AGE, fill=CLASSE)) + geom_boxplot()
ggplot(data, aes(x=SEXE, y=AGE, fill=CLASSE)) + geom_boxplot()
ggplot(data, aes(x=CLASSE, y=AGE, fill=CLASSE)) + geom_boxplot()
model <- lm(cbind(CLASSE, SEXE) ~ AGE, data)
Manova(model, test.statistic = "Pillai")
model <- lm(CLASSE ~ AGE, data)
Manova(model, test.statistic = "Pillai")
library(car)
model <- manova(cbind(AGE, CLASSE) ~ SEXE, data=data)
summary(model)
data$AGE
data$CLASSE
length(data$CLASSE)
length(data$SEXE)
length(data$AGE)
?NaN
is.nan(data$SEXE)
sum(is.nan(data$SEXE))
sum(is.nan(data$CLASSE))
sum(is.nan(data$AGE))
library(car)
model <- manova(cbind(SEXE, CLASSE) ~ AGE, data=data)
summary(model)
library(car)
model <- model <- manova(AGE ~ CLASSE + SEXE, data=data)
summary(model)
library(vcd)
result <- chisq.test(table(data$SEXE, data$CLASSE))
result
result <- chisq.test(table(data$AGE, data$CLASSE))
result
result <- chisq.test(table(data$AGE, data$SEXE))
result
result <- chisq.test(table(data$AGE, data$CLASSE))
result
?chisq_test
result <- chisq.test(table(data$AGE, cbind(data$CLASSE,data$SEXE)))
result
library(vcd)
result <- chisq.test(table(data$SEXE, data$CLASSE))
result
result <- chisq.test(table(data$AGE, cbind(data$CLASSE,data$SEXE)))
result
result <- chisq.test(table(data$AGE, cbind(data$CLASSE,data$SEXE)))
result
result <- chisq.test(table(data$AGE, cbind(data$CLASSE,data$SEXE)))
result
result <- chisq.test(table(data$AGE, cbind(data$CLASSE,data$SEXE)))
result
result <- chisq.test(table(data$AGE, cbind(data$CLASSE,data$SEXE)))
result
result <- chisq.test(table(data$AGE, cbind(data$CLASSE,data$SEXE)))
result
result <- chisq.test(table(data$AGE, cbind(data$CLASSE,data$SEXE) ))
result
result <- chisq.test(cbind(data$SEXE,data$CLASSE), data$AGE)
result
result <- chisq.test(cbind(data$SEXE,data$CLASSE), data$AGE)
result
result <- chisq.test(cbind(data$SEXE,data$CLASSE), data$AGE)
result
?chisq.test
result <- chisq.test(cbind(data$SEXE,data$CLASSE), data$AGE)
result
result <- chisq.test(table(data$AGE, data$SEXE))
result
result <- chisq.test(cbind(data$SEXE,data$CLASSE), data$AGE)
result
result <- chisq.test(data$SEXE, data$AGE)
result
result <- chisq.test(table(data$SEXE,data$CLASSE), data$AGE)
result
result <- chisq.test(x=table(data$SEXE,data$CLASSE),y= data$AGE)
result
result <- chisq.test(x=table(data$SEXE,data$CLASSE),y= data$AGE)
result
result <- chisq.test(x=table(data$SEXE,data$CLASSE),y= data$AGE)
result
result <- chisq.test(x=table(data$SEXE,data$CLASSE),y= data$AGE)
result
ggplot(data, aes(x=CLASSE, y=AGE, fill=CLASSE)) + geom_boxplot()
ggplot(data, aes(x="", y=DATE, fill=DATE)) + geom_bar(width = 1, stat = "identity") + coord_polar("y", start=0)
library(ggplot2)
ggplot(data, aes(x=CLASSE)) + geom_bar(aes(fill=CLASSE))
